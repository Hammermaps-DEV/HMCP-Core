
/*!
 * Minify URI Builder
 */
var MUB={_uid:0,_minRoot:"/min/?",checkRewrite:function(){var b=location.pathname.replace(/\/[^\/]*$/,"/rewriteTest.js").substr(1);function a(){$("#minRewriteFailed")[0].className="topNote"}$.ajax({url:"../f="+b+"&"+(new Date()).getTime(),success:function(c){if(c==="1"){MUB._minRoot="/min/";$("span.minRoot").html("/min/")}else{a()}},error:a})},newLi:function(){return'<li id="li'+MUB._uid+'">http://'+location.host+'/<input type=text size=20> <button class="btn btn-danger btn-sm" title="Remove">x</button> <button class="btn btn-default btn-sm" title="Include Earlier">&uarr;</button> <button class="btn btn-default btn-sm" title="Include Later">&darr;</button> <span></span></li>'},addLi:function(){$("#sources").append(MUB.newLi());var a=$("#li"+MUB._uid)[0];$("button[title=Remove]",a).click(function(){$("#results").addClass("hide");var b=!!$("input",a)[0].value;$(a).remove()});$("button[title$=Earlier]",a).click(function(){$(a).prev("li").find("input").each(function(){$("#results").addClass("hide");var b=this.value;this.value=$("input",a).val();$("input",a).val(b);MUB.updateAllTestLinks()})});$("button[title$=Later]",a).click(function(){$(a).next("li").find("input").each(function(){$("#results").addClass("hide");var b=this.value;this.value=$("input",a).val();$("input",a).val(b);MUB.updateAllTestLinks()})});++MUB._uid},liUpdateTestLink:function(){if(!$("input",this)[0].value){return}var a=this;$("span",this).html("");var b=location.protocol+"//"+location.host+"/"+$("input",this)[0].value.replace(/^\//,"");$.ajax({url:b,complete:function(d,c){if("success"===c){$("span",a).html('<a href="#" class="btn btn-success btn-sm disabled">&#x2713;</a>')}else{$("span",a).html('<button class="btn btn-warning btn-sm"><b>404! </b> recheck</button>').find("button").click(function(){MUB.liUpdateTestLink.call(a)})}},dataType:"text"})},updateAllTestLinks:function(){$("#sources li").each(MUB.liUpdateTestLink)},getCommonCharAtPos:function(a,f){var d,b=a.length,e=a[0].charAt(f);if(e===""||b===1){return e}for(d=1;d<b;++d){if(a[d].charAt(f)!==e){return""}}return e},getBestUri:function(a){var j=0,b="",h;while(true){h=MUB.getCommonCharAtPos(a,j);if(h===""){break}else{b+=h}++j}b=b.replace(/[^\/]+$/,"");var d=MUB._minRoot+"f="+a.join(",");if(b.charAt(b.length-1)==="/"){var k=a,f,e=a.length;for(f=0;f<e;++f){k[f]=a[f].substr(b.length)}b=b.substr(0,b.length-1);var g=MUB._minRoot+"b="+b+"&f="+k.join(",");d=d.length<g.length?d:g}return d},update:function(){MUB.updateAllTestLinks();var d=[],e=false,b=false,c;$("#sources input").each(function(){var g,i;if(!b&&this.value&&(g=this.value.match(/\.(css|js)$/))){var h=g[1];if(e===false){e=h}else{if(h!==e){b=true;return alert("extensions must match!")}}this.value=this.value.replace(/^\//,"");if(-1!==$.inArray(this.value,d)){b=true;return alert("duplicate file!")}d.push(this.value)}});if(b||!d.length){return}$("#groupConfig").val("    'keyName' => array('//"+d.join("', '//")+"'),");var f=MUB.getBestUri(d),a=f.replace(/</,"&lt;").replace(/>/,"&gt;").replace(/&/,"&amp;");$("#uriA").html(a)[0].href=f;if(e==="js"){c='<script type="text/javascript" src="'+a+'"><\/script>'}else{c='<link type="text/css" rel="stylesheet" href="'+a+'" />'}$("#uriHtml").val(c);$("#results").removeClass("hide")},addButtonClick:function(){$("#results").addClass("hide");MUB.addLi();MUB.updateAllTestLinks();$("#update").removeClass("hide").click(MUB.update);$("#sources li:last input")[0].focus()},init:function(){$("#jsDidntLoad").remove();$("#app").removeClass("hide");$("#sources").html("");$("#add button").click(MUB.addButtonClick);$("#uriHtml, #groupConfig, #symlinkOpt").click(function(){this.select()}).focus(function(){this.select()});$("a.ext").attr({target:"_blank"});if(location.hash){$("#getBm").addClass("hide");var c=0,d=location.hash.substr(1).split(","),a=d.length;$("#bmUris").html("<p><strong>Found by bookmarklet:</strong> /</p>");var b=$("#bmUris p");for(;c<a;c++){b.append($("<a href=#></a>").text(d[c])[0]);if(c<(a-1)){b.append(", /")}}$("#bmUris a").click(function(){MUB.addButtonClick();$("#sources li:last input").val(this.innerHTML);MUB.liUpdateTestLink.call($("#sources li:last")[0]);$("#results").addClass("hide");return false}).attr({title:"Add file +"})}else{$.ajax({url:"../?f="+location.pathname.replace(/\/[^\/]*$/,"/bm.js").substr(1),success:function(e){$("#bm")[0].href=e.replace("%BUILDER_URL%",location.href).replace(/\n/g," ")},dataType:"text"});if($.browser.msie){$("#getBm p:last").append(" Sorry, not supported in MSIE!")}MUB.addButtonClick()}$.ajax({url:"../?f="+location.pathname.replace(/\/[^\/]*$/,"/bm2.js").substr(1),success:function(e){$("#bm2")[0].href=e.replace(/\n/g," ")},dataType:"text"});MUB.checkRewrite()}};$(MUB.init);